Perfecto Manuel üî• ‚Äî este es el punto crucial para **entender de verdad** los problemas de m√≠nimos cuadrados, tanto lineales como no lineales.  
Vamos a empezar **desde cero**, paso a paso, para que entiendas **de d√≥nde sale el m√≠nimo de** \( \|A x - b\|_2^2 \), qu√© significa geom√©tricamente y c√≥mo aparece naturalmente la derivada matricial con transpuestas.

---

## üß© 1. El problema original: un sistema sobredeterminado

Imagina que tienes m√°s ecuaciones que inc√≥gnitas:

$$
A x = b, \quad A \in \mathbb{R}^{m \times n}, \; m > n
$$

Es decir:

$$
\begin{cases}
a_{11}x_1 + a_{12}x_2 + \dots + a_{1n}x_n = b_1 \\
a_{21}x_1 + a_{22}x_2 + \dots + a_{2n}x_n = b_2 \\
\vdots \\
a_{m1}x_1 + a_{m2}x_2 + \dots + a_{mn}x_n = b_m
\end{cases}
$$

Cuando \( m > n \), **no hay soluci√≥n exacta** normalmente, porque las ecuaciones son demasiadas y no compatibles entre s√≠.  
Entonces, buscamos un vector \( x \) que ‚Äúaproxime lo mejor posible‚Äù a \( b \).

---

## üß† 2. Idea geom√©trica

- \( A x \) representa un **vector en el subespacio columna de \( A \)**.  
- Queremos que \( A x \) est√© **lo m√°s cerca posible** de \( b \).

El error o residuo es:

$$
r = A x - b
$$

Y su norma cuadr√°tica mide ‚Äúcu√°nto nos alejamos‚Äù:

$$
\|r\|_2^2 = (A x - b)^T (A x - b)
$$

üëâ Entonces el problema es:

$$
\min_{x \in \mathbb{R}^n} \|A x - b\|_2^2
$$

Esto es lo que significa ‚Äúajustar los datos lo mejor posible en el sentido de m√≠nimos cuadrados‚Äù.

---

## ‚öôÔ∏è 3. Expandiendo la funci√≥n objetivo

$$
f(x) = \|A x - b\|_2^2 = (A x - b)^T (A x - b)
$$

Expandimos:

$$
f(x) = x^T A^T A x - 2 b^T A x + b^T b
$$

Esto es una **funci√≥n cuadr√°tica** en \( x \).

---

## üîß 4. Derivada matricial paso a paso

Queremos encontrar el m√≠nimo, entonces derivamos respecto a \( x \).

Usamos las reglas de derivaci√≥n matricial:

1. Derivada del t√©rmino cuadr√°tico:

$$
\frac{\partial}{\partial x}(x^T C x) = (C + C^T)x
$$

2. Derivada del t√©rmino lineal:

$$
\frac{\partial}{\partial x}(d^T x) = d
$$

Como es sim√©trica:

$$
A^T A = (A^T A)^T
$$

Entonces:

$$
\nabla_x f(x) = 2 A^T A x - 2 A^T b
$$

---

## üéØ 5. Condici√≥n de primer orden (m√≠nimo)

En el m√≠nimo, el gradiente es cero:

$$
\nabla_x f(x) = 0 \quad \Rightarrow \quad A^T A x = A^T b
$$

Estas son las **ecuaciones normales** del problema de m√≠nimos cuadrados.

Si \( A^T A \) es invertible (rango completo):

$$
x^* = (A^T A)^{-1} A^T b
$$

---

## üìê 6. Interpretaci√≥n geom√©trica del resultado

El vector \( A x^* \) es la **proyecci√≥n ortogonal** de \( b \) sobre el subespacio columna de \( A \).  
Esto significa que el residuo \( r = b - A x^* \) es **perpendicular** a todas las columnas de \( A \):

$$
A^T (A x^* - b) = 0
$$

Por eso aparece la transpuesta: se impone la condici√≥n de **ortogonalidad** entre el error y el espacio generado por \( A \).

---

## üßÆ 7. Ejemplo num√©rico (MATLAB)

```matlab
% Ejemplo sencillo
A = [1 1; 1 2; 1 3];   % 3 ecuaciones, 2 inc√≥gnitas
b = [1; 2; 2.5];

% Soluci√≥n anal√≠tica de m√≠nimos cuadrados
x_ls = (A' * A) \ (A' * b)

% Predicci√≥n y residuo
b_hat = A * x_ls;
r = b - b_hat;

% Verificamos ortogonalidad
disp(A' * r)   % Debe dar (casi) cero
